<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Глава 7: GET и POST</title>
</head>
<body>
    <header>
        <h1>HTML 5 <br>CSS 3</h1>
    </header>

    <nav>
        <a href="index.html">Main</a>
        <a href="#">News</a>
        <a href="#">Downloads</a>
        <a href="#">Forum</a>
        <a href="#">Contacts</a>
    </nav>

    <aside>
        <a href="index.html">Main</a>
        <a href="audio.html">Audio</a>
        <a href="video.html">Video</a>
    </aside>

    <article>
        <h2>Глава 7. <br> Форми за въвеждане на данни. Методи GET и POST</h2>

        <!--& Глава7:  Форми за въвеждане на данни. Методи GET и POST-->

        <hr>

        <ul type="none">
            <li>Глава 7. Форми за въвеждане на данни. Методи GET и POST
                <ul type="none">
                    <li>7.1. Форма. Таг FORM</li>
                    <li>7.2. Получаване на данни от форма</li>
                    <li>7.3. Елементи за въвеждане на данни</li>
                        <ul type="none">
                            <li>7.3.1. Текстови полета за въвеждане на данни</li>
                            <li>7.3.2. Зависими и независими превключватели</li>
                            <li>7.3.3. Таг TEXTAREA</li>
                            <li>7.3.4. Списъци</li>
                            <li>7.3.5. Бутони</li>
                        </ul>
                    </li>
                    <li>7.4. Защита от спам</li>
                </ul>
            </li>
        </ul>

        <!--& 7.1. Форма. Таг FORM -->
        <!-- ⁡⁢⁣⁣таг form⁡ - за описване на формите
            Най-важните параметри на ⁡⁢⁣⁣form⁡ са ⁡⁢⁣⁣action⁡ и ⁡⁢⁣⁣method⁡.
            ⁡
            ⁢⁣⁣action⁡ указва името на сценария, на който ще се предадат данните.
            ⁡⁢⁣⁣method⁡ задава метода, по който ще стане това:
            
            <form action="сценарий" method="метод"> Например:
        -->
        
        <form action="index.php" method="get"></form>
        <!-- Тук въведените от потребителя данни ще се предадат на index.php сценария, посредством get метода.
            ⁡⁢⁣⁣get method ⁡предава параметрите в адресната лента веднага, след като потребителя натисне бутон SUBMIT. Адресната лента се променя по следният начин:
            ⁡⁣⁢⁡⁣⁢⁣http://сървър/index.php?param1=value1&...&paramN=valueN⁡
            ⁡⁢⁣⁣param1, param2, ..., paramN⁡ имена на елементите на формата

            Пример:
            Имаме форма, която има поле с име username, на сценария ще се предаде поле с това име. Стойността и ще бъде въведеното от потребителя в полето за въвеждане на данни.
            
            Ако имаме 2 текстови полета - username -> den, password -> 123456
            - Потребителят въвежда ст-ст на първото "den", а на второто "123456".
            - В този случай на нашият сценарий се предават следните параметри:
            
            ⁡⁣⁢⁣http://сървър/index.php?username=den&passwd=123456⁡
            Паролата на потребителя се показва в адресната лента на браузъра.
            Данните, предадени с get се записват в лог файла на сървъра.
            => Хостинг провайдърът може да разбере паролите на потребителите в сайта ни, което е недопустимо. (Решение post)

            ⁡⁢⁣⁣post method⁡ предава данните по по-различен начин.
                - Предаваните данни не се показват в адресната лента на браузъра.
            
           ⁡⁢⁣⁣ Използваме метода post в 2 случая:⁡
            1) Предаваните данни не трябва да се виждат. Пример: име и парола
            2) Когато физически е невъзможно предаването на данни като URL.
                - В зависимост от браузъра max дължина за URL е различна, а и защото това няма как да стане с GET, трябва да използваме post.

           ⁡⁢⁣⁣ Символите от националните азбуки се кодират по специален начин:⁡
            - Първо всеки символ от национална азбука се кодира в UTF-8, т.е. в последователност от 2 байта.
            - След това всеки байт се представя в шестнадесетичен вид.
            - Става така, че във всеки байт, кодиран по този начин в URL, се появяват нови 6 символа.

            Пример: БГ "М" -> кодирана като %DO%9C
            - Това намаля позволената дължина до 347, ако са от национална азбука.

            В повечето случаи е по-добре да използваме метода post.    -->

        <!-- След тага <form> се поставят таговете, които описват полето за въвеждане на данни: таговете INPUT (или други)
            Накрая затваряме формата </form>

            ⁡⁢⁣⁣Пример 1: ⁡форма за изпращане на потребителско име и парола 
                ! Използваме даблици за подравняване на елементите на формата.
        -->
        <table border="0">
            <form action="test.php" method="post">
                <tr>
                    <td>Login: </td>
                    <td><input type="text" name="login"></td>
                </tr>
                <tr>
                    <td>Password: </td>
                    <td><input type="password" name="password"></td>
                </tr>
                <tr>
                    <td colspan="2"><input type="submit" value="Login"></td>
                </tr>
            </form>
        </table>    <br><hr><br>

        <!-- - Ако бяхме използвали метод GET и потребителят въведе den 123456 за потр. име и парола, адресната лента на браузъра би изглеждала така:
        ⁡⁣⁢     ⁣http://localhost/test.php?login=den&password=123456⁡

            - Използвахме post, адресната лента изглежда така:
            http://localhost/test.php

            - Данните (име и парола) ще бъдат предадени в скрит вид.
            - След последния елемент за въвеждане на данни трябва да поставим затварящ таг </form>        

            ⁡⁢⁣⁣Форми за изпращане на файл:⁡
            - Една форма е за изпращане на файлове, ако поне 1 поле е за изпращане на файл.
            - Формата съдържа атрибут ⁡⁢⁣⁣enctype⁡, а стойността му трябва да е ⁡⁢⁣⁣"multipart/form-data"⁡ 
        -->
        <form action="upload.php" enctype="multipart/form-data" method="post">
            <p>Filename:    </p>
            <p><input type="file" name="fname"></p>
        </form>          <br><hr><br>


        <!-- ⁡⁢⁣⁣атрибути на тага form:⁡ accept-charset, action, autocomplete, enctype, method, name, novalidate, target -->


        <!--& 7.2. Получаване на данни от форма -->
        <!-- Понякога html и php кода е заедно. 
            Пример: Имаме сценарий. На входа му подаваме параметри, но не знаем имената им.
            Тогава трябва да отворим сценария и да видим какви имена очаква, но и също какъв метод за предаване на данни трябва да използваме.
            
            Езици за уебпрограм. - PHP, ASP.NET и др. средства за разраб. на уеб прил.

            ⁡⁢⁣⁣Клиентски езици за програмиране:⁡ JavaScript, VBScript
            ⁡⁢⁣⁣Сървърни езици за програмиране:⁡ PHP, ASP.NET, Perl, JSP и др.
            
            ⁡⁢⁣⁣PHP:⁡ използва се за обработване на даннит, които се съхраняват на сървър.
            ⁡⁢⁣⁣JavaScript:⁡ с него създаваме интерактивния интерфейс.

            ⁡⁢⁣⁣Пример:⁡ проверка на въведените данни
                    Създава различни визуални ефекти в прозореца на браузъра.
        -->

        <!-- 
            Данните предадени с GET се получават с глобалния масив $_GET:
            ⁡⁢⁢⁢$_GET['име на параметъра']⁡

            Използваме echo (в PHP) за показване на текст.            

            Параметрите ни login и password (имената на полето за въвеждане, зададени с тагове name) показваме на екрана:
            ⁡⁢⁢⁢echo $_GET['login'];
            echo $_GET['password'];⁡

            Отваряме сценария и търсим ⁡⁢⁢⁢$_GET⁡, ⁡⁢⁢⁢$_POST⁡ или ⁡⁢⁢⁢$_REQUEST⁡.

            Ако програмиста използва масив $_GET и вие ще трябва да използвате него, същото се отнася и за $_POST.      -->


        <!--& 7.3. Елементи за въвеждане на данни -->
        <!-- ⁡⁢⁣⁣Елементите за въвеждане на данни биват:⁡
                1. текстови полета за въвеждане на данни
                2. превключватели (зависими и независими)
                3. поле за въвеждане на многоредов текст
                4. списъци
                5. бутони

            ⁡⁢⁣⁣таг input ⁡- с него можем да създадем повече елементи за въвеждане на данни
            ⁡⁢⁣⁣атрибути на таг input:⁡
            accept, accesskey, align, alt, autocomplete, autofocus, border, checked, disabled, form, formaction, formenctype, formtarget, list, max, maxlength, min, multiple, name, pattern, placeholder, readonly, required, size, step, tabindex, type, value    -->


        <!-- & Създаване на елементи за въвеждане на данни (бутони, полета за въвеждане и др.) и и използване на атрибутите на таг input:
    
        & 1) Текстови полета за въвеждане на данни 

        ⁡⁢⁣⁣биват:⁡  ⁡⁢⁢⁢text, password, hidden, search  ⁡
        
        ⁡⁢⁢⁢password:⁡ при въвеждане на текст в това поле, символите се заместват с * или •, но данните не се шифрират и се придават в открит вид между формата и сценария. Затова трябва да не се използва GET тук.

        ⁡⁢⁢⁢hidden:⁡ полето не се показва в браузъра, но стойността му се предава към сценария

        ⁡⁢⁢⁢search: ⁡поле за търсене; 
    
        ⁡⁢⁣⁣Примери:⁡   -->

        <input type="text" name="mytext">
        <input type="password" name="pass">
        <input type="hidden" name="hidden_text">        <br><hr><br>

        <!-- В PHP може да получим достъп до ↑ тези данни или чрез масивите $_GET и $_POST или чрез масива $_REQUEST: -->
        echo $_REQUEST['mytext'];
        echo $_REQUEST['pass'];
        echo $_REQUEST['hidden_text'];

        <br><hr><br>
        
        <!-- Параметри ⁡⁢⁣⁣size⁡ и ⁡⁢⁣⁣maxlength⁡ задават броя на показваните символи в полето и максималния брой символи в него.

        ⁡⁢⁣⁣Пример:⁡ поле - показва 25 символа, макс. въвеждане 50 символа -->
        <input type="text" name="mytext" size="25" maxlength="50">  <br><hr><br>

        <!-- атрибут ⁡⁢⁣⁣readonly⁡ не позволява информацията в полето да бъде променяна, а само да се копира. -->

        <!-- атрибут ⁡⁢⁣⁣autofocus⁡ поставя фокуса върху полето за въвеждане веднага след зареждане на страницата. Пример: -->
        <input type="text" name="mytext" value="Copy this text" readonly>           <!-- 1. -->
        <input type="text" name="mytext" autofocus>        <br><hr><br>             <!-- 2. -->

        <!--Таг 1. създава поле, достъпно само за четене. Полето ще съдържа текст "Copy this text".
            Таг 2. създава поле с автофокус. Когато страницата зареди в браузъра, това поле автоматично става активно и въвеждането на данни ще започне от него.
        
        search текстово поле не се различава от обикновеното, с разликата, че от въвеждането в него автоматично се премахват преносите за нов ред. Атрибутите му са същите като на текстово поле.  -->
            
        <form action="#">
            <p>Search: <input type="search" name="keyword" size="50"></p>
        </form>
        
        <!--  тагът ⁡⁢⁣⁣datalist⁡ дефинира списък с данни/варианти, които са допустими за въответното поле. ⁡⁢⁣⁣Пример:⁡ -->
        <p><input list="character">
            <datalist id="character">
                <option value="Audi"></option>
                <option value="BMW"></option>
                <option value="Mercedes"></option>
        </datalist></p>         <br><hr><br>



        <!--& 2) Зависими и независими превключватели -->
        <!--⁡⁢⁣⁣Независим превключвател:⁡ това е тип чекбокс на тага input.
               ⁡⁢⁣⁣включен превключвател:⁡⁡  на сценария се предава параметър, указан в name аргумента със стойност, указана в аргумента value.
               ⁡⁢⁣⁣изключен превключвател:⁡ параметърът не се предава.
            
        ⁡⁢⁣⁣Пример:⁡ имаме превключвател и ако се включи означава, че потребителят се е съгласил с лицензното споразумение.  𐄂I agree   -->
        <input type="checkbox" name="agree" value="yes">I agree
        
        <!-- Можем да проверим дали потребителя се е съгласил с лицензното споразумение: -->
        if (isset ($_REQUEST['agree'])) {
            <!-- потребителят е съгласен с лицензното споразумение -->
        } else {
            <!-- потребителят не е съгласен, показваме някакво съобщение и приключваме работа -->
        }   <br>

        die('Sorry, but this product is extends under GPL license');    <br>

        <!-- ⁡⁢⁣⁣атрибут⁡ ⁡⁢⁣⁣checked:⁡ прави превключвателя включен по подразбиране -->
        <input type="checkbox" name="agree" checked value="yes">I agree         <br><hr><br>

        <!-- ⁡⁢⁣⁣Важното⁡ при ⁡⁢⁣⁣независимите⁡ ⁡⁢⁣⁣превключватели⁡ е името, а не толкова стойността. Трябва да знаем дали превключвателя е бил натиснат. ⁡⁣⁣⁡⁢⁣
        ⁣Пример:⁡⁡ зависим превключвател -->
        Sex:
        <br><input type="radio" name="sex" value="M">Male
        <br><input type="radio" name="sex" value="F">Female
        <br><hr><br>


        <!-- ⁡⁢⁣⁣Зависим превключвател:⁡ трябва да имаме поне 2 превключвателя с еднакви имена.
        - Превключватели с едно и също име принадлежат към една група. В даден момент само един превключвател от тази група може да е активен. ⁡⁢⁣⁣
        
        Пример:⁡ предния пример
        Тук имаме 1 група превключватели с име sex. В групата има 2 зависими превключвателя. Нито един от тях не е активен по подразбиране. Когато потребителя направи избора си, към сценария ще се предаде параметъра sex със стойност M или F. Ако потребителят не направи избор, параметърът sex няма да се предаде.
        
        ⁡⁢⁣⁣Пример:⁡ разработка на група превключватели    -->
        if (!isset($_REQUEST['sex'])) {
            die('Please specify your sex');
        } else {
            switch ($_REQUEST['sex']) {
                case 'M': echo "Male"; break;
                case 'F': echo "Female"; break;
            }
        }

        <!-- Понякога на една страница има 2 групи превключватели. Всяка група трябва да има свое име. -->
        <!-- При зависимите превключватели също можем да направим един от превключвателите активен.
        Пример: -->
        OS:
        <br><input type="radio" name="os" checked value="win">Windows
        <br><input type="radio" name="os" value="linux">Linux
        <br><input type="radio" name="os" value="macos">Mac OS

        <!-- Стойностите на всички аргументи трябва да са в кавички, но понякога дизайнерите слагат само на стойностите с интервали в тях.
        Пример: -->
        <br><input type=radio name=os value="Mac OS">Mac OS

        <!-- Избягвайте интервалите при задааване на стойности. Така ще намалите обема на предаваната информация, особено при метод GET. "Mac OS" -> "macos"
        Може да използваме числови означения. В този случай ще можем лесно да ги обработим със switch-case. -->
        OS:
        <br><input type="radio" name="os" checked value="1">Windows
        <br><input type="radio" name="os" checked value="2">Linux
        <br><input type="radio" name="os" checked value="3">Mac OS

        <!-- Пример: обработка със switch-case -->
        switch ($_REQUEST['os']) {
            case 1: echo "Windows"; break;
            case 2: echo "Linux"; break;
            case 3: echo "Mac OS"; break;
            default: echo "Unknown OS"; break;
        }

        <br><hr><br>

        <!--& 3) Таг TEXTAREA -->
        <!-- ⁡⁢⁣⁣Едноредови полета:⁡ подходящи за въвеждане на малък по обем текст. 
        ⁡⁢⁣⁣Мног⁡⁢⁣⁣оредов текст: използваме тага ⁡⁢⁣⁣textarea⁡. Пример за такъв е коментар във форум.⁡
        
        ⁡⁢⁣⁣атрибути на тага textarea:⁡ accesskey, autofocus, cols, disabled, form, maxlength, name, placeholder, readonly, required, rows, tabindex, wrap  -->
        
        <textarea name="comment" cols="50" rows="15">Comment</textarea>     <br><br>

        <!-- параметърът ⁡⁢⁣⁣name⁡ задава името на елемента за въвеждане
        cols: броя на видимите колони
        rows:броя на видимите редове
        
        Текстът между <textarea> и </textarea> е стойност на елемента за въвеждане.
        По подразбиране не е нужно да слагаме текст между таговете и парам. rows и cols са незадължителни:  -->
        <textarea name="comment"></textarea>    <br><br>

        <!-- За всичко останало полето ⁡⁢⁣⁣textarea⁡ работи като обикновено поле: -->
        echo $_REQUEST['comment'];  <br><br>

        <!-- атрибутите ⁡⁢⁣⁣r⁡⁡⁢⁣⁣eadonly, autofocus, wrap⁡ за textarea
        ⁡⁢⁣⁣wrap: ⁡управляваме пренасяне на редовете в областта textarea. Има 2 стойности - ⁡⁢⁣⁣"soft" и "hard".⁡
            - ⁡⁢⁣⁣soft:⁡ стойност по подразбиране; редовете се пренасят визуално, без да се поставя символ за пренос на края на редовете
            - ⁡⁢⁣⁣hard:⁡ поставят се символи за пренос (тирета), където е необходимо. -->


        <!--& 4) Списъци - таг SELECT -->
        <!-- ⁡⁢⁣⁣атрибути на таг select:⁡ accesskey, autofocus, disabled, form, multiple, name, required, size, tabindex  
        Пример:  -->

        <select name="year" size="1">
            <option value="2017">2017</option>
            <option value="2016">2016</option>
            <option value="2015">2015</option>
            <option value="2014">2014</option>
        </select>   <br><br>

        <!-- Списъците ни позволяват да избираме 1 или няколко варианта. Горният пример позволява избирането на 1 вариант.
        За такива списъци задаваме стойност на размера size-1. 
        За да може да избираме няколко варианта, трябва да добавим аргумента multiple: -->

        <select name="year2[]" size="5" multiple>
            <option value="2017">2017</option>
            <option value="2016">2016</option>
            <option value="2015">2015</option>
            <option value="2014">2014</option>
            <option value="2013">2013</option>
            <option value="2012">2012</option>
            <option value="2011">2011</option>
            <option value="2010">2010</option>
        </select>   <br><br>

        <!-- Обърнете внимание на името (атрибута name) в списъка ("year2[]"). Квадратните скоби слагаме, за да обозначим, че потребителят може да избере няколко варианта. Добре е да ги изберете от масива , който ще бъде предаден на сценария. 
        
        Note: с обикновения списък е ясно, имаме само 1 стойност.
        Пример: код, който обработва списъка -->

        $year =  $_REQUEST['year'];
        echo $year;                     <br><br>

        <!-- За списък с повече от 1 елемент трябва да обработим масива:  -->
        foreach($_REQUEST[year2] as $key=>$value) echo "<br>$value";        <br><br>


        <!--& 5) Бутони - два вида бутони (Submit и Reset) -->
        <!-- ⁡⁢⁣⁣Submit:⁡ изпраща въведените от потребителя данни към сценария, указан с аргумента action на тага form.
        ⁡⁢⁣⁣Reset:⁡ изчиства формата (въведеното от потребителя) и се установяват стойностите по подразбиране.  -->

        <input type="submit" value="ok">
        <input type="reset" value="reset">

        <!-- Задаването имената на бутоните не е задължително.
        С аргумента ⁡⁢⁣⁣value⁡ задаваме това, което потребителя ще види в браузъра.
        Може да използваме бутони във вид на изображения:    -->

        <input type="image" src="image.gif" value="party on...">

        <!-- ⁡⁢⁣⁣src:⁡ задава името на изображението;  
        ⁡⁢⁣⁣value:⁡ ще се използва от текстовите браузъри или ако не се зареди изображението;
        За всичко останало графичният бутон работи като обикновен бутон. -->


        <!--& 7.4. Защита от спам -->
        <!-- Най-лесният начин да се предпазим от спам ботове е да създадем поле за проверка.
        Може да добавим към формата поле, в което потребителя да въведе отговор на въпрос.
        Един от механизмите за проверка е CAPTCHA, предоставена от Google reCAPTCHA. С нея данните не се обработват от сценария, докато не въведем всички правилни символи.
        
       ⁡⁣⁢⁣ http://www.google.com.recaptcha⁡
        => регистрация => 2 ключа (public, private)
        => download archive contained recaptchalib.php from the webpage above.
        => разархивирайте в папката, която е вашата форма/сценарий, който ще я обработва.

        - Ако досега сме използвали HTML форма, трябва да я визуализираме с PHP, иначе няма да вградим reCAPTCHA.
        - Лесно е, трябва да визуализираме HTML кода с помощта на echo.
        Пример:    -->
        echo "<form action="index.php" method="post">
              <br>Name: <input type=text name=username>
              <br>Address: <input type="text" name="address">...";
        
        <!-- Ако HTML кода има ⁡⁢⁣⁣кавички⁡, трябва да ги защитим със символа ⁡⁢⁣⁣\⁡: -->
        echo "<input type=\"text\" name=\"username\">";

        <!-- Преди показване на Submit бутон, трябва да се покаже reCAPTCHA формата: -->
        require_once('recaptchalib.php');
        <!-- Тук поставяме нашия public key -->
        $publickey = "public key";
        recaptcha_get_html($publickey);

        <!-- След това вече може да се покаже бутон Submit: -->
        echo "<input type=submit value=ok>"

        <!-- В сценария, който ще обработва формата (index.php в този случай) трябва да добавим: -->
        require_once(recaptchalib.php);
        <!-- Тук поставяме нашия private key -->
        $privatekey="private key";
        $resp=recaptcha_check_answer($privatekey, $_SERVER["REMOTE_ADDR"],
                                                  $_POST["recaptcha⁡_challenge_field"],
                                                  $_POST["recaptcha_response_field"]);
        if (!$resp->is_valid){
            <!-- Какво ще правим, ако въведената фраза не е правилна? -->
            die("wrong captcha phrase");
        }
        <!-- Въведена фраза - правилна. Оттук започва нормален PHP код, който ще обработи данните от формата. -->



    </article>
    
    <footer align="center">    @copy Kristina Ch.      </footer>

</body>
</html>
